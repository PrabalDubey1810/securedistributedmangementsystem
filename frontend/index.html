<!DOCTYPE html>
<html>
<head>
<title>Microservices App</title>
</head>
<body>

<h2>Register</h2>
<input id="ruser">
<input id="rpass" type="password">
<button onclick="register()">Register</button>

<h2>Login</h2>
<input id="luser">
<input id="lpass" type="password">
<button onclick="login()">Login</button>

<h2>Private Data</h2>
<button onclick="getData()">Get Data</button>

<pre id="out"></pre>

<script>

let token="";

function register(){
fetch("http://localhost:8000/auth/register",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
username:ruser.value,
password:rpass.value
})
})
.then(r=>r.json())
.then(d=>out.innerText=JSON.stringify(d))
}


function login(){
fetch("http://localhost:8000/auth/login",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({
username:luser.value,
password:lpass.value
})
})
.then(r=>r.json())
.then(d=>{
token=d.token
out.innerText="Logged In"
})
}


function getData(){
fetch("http://localhost:8000/data",{
headers:{
"Authorization":"Bearer "+token
}
})
.then(r=>r.json())
.then(d=>out.innerText=JSON.stringify(d))
}

</script>

</body>
</html>
